### Test Collection for Construction Planner API

### Task Registration Endpoints (For Dynamic Task Management)

### 1. Register Tasks - From tasks.json file
# Registers tasks from the tasks.json file, replacing any existing tasks in memory
POST http://localhost:8080/api/tasks
Content-Type: application/json

< ./tasks.json

###

### 2. Register Tasks - Simple Example
# Registers a new task list, replacing any existing tasks in memory
POST http://localhost:8080/api/tasks
Content-Type: application/json

[
  {
    "taskCode": "A",
    "operationName": "Foundation",
    "elementName": "Building A",
    "duration": 5,
    "crew": {
      "name": "Crew 1",
      "assignment": 3
    },
    "equipment": [
      {
        "name": "Excavator",
        "quantity": 1
      }
    ],
    "dependencies": []
  },
  {
    "taskCode": "B",
    "operationName": "Walls",
    "elementName": "Building A",
    "duration": 10,
    "crew": {
      "name": "Crew 2",
      "assignment": 5
    },
    "equipment": [
      {
        "name": "Crane",
        "quantity": 1
      }
    ],
    "dependencies": [
      "A"
    ]
  },
  {
    "taskCode": "C",
    "operationName": "Roof",
    "elementName": "Building A",
    "duration": 7,
    "crew": {
      "name": "Crew 3",
      "assignment": 4
    },
    "equipment": [
      {
        "name": "Crane",
        "quantity": 1
      },
      {
        "name": "Scaffolding",
        "quantity": 1
      }
    ],
    "dependencies": [
      "B"
    ]
  }
]

###

### 3. Register Tasks - Complex Example
POST http://localhost:8080/api/tasks/register
Content-Type: application/json

[
  {
    "taskCode": "T1",
    "operationName": "Site Preparation",
    "elementName": "Site",
    "duration": 3,
    "crew": [{"name": "Site Crew", "count": 2}],
    "equipment": ["Bulldozer"],
    "dependencies": []
  },
  {
    "taskCode": "T2",
    "operationName": "Excavation",
    "elementName": "Foundation",
    "duration": 5,
    "crew": [{"name": "Excavation Crew", "count": 4}],
    "equipment": ["Excavator", "Dump Truck"],
    "dependencies": ["T1"]
  },
  {
    "taskCode": "T3",
    "operationName": "Foundation Pouring",
    "elementName": "Foundation",
    "duration": 4,
    "crew": [{"name": "Concrete Crew", "count": 6}],
    "equipment": ["Concrete Mixer"],
    "dependencies": ["T2"]
  },
  {
    "taskCode": "T4",
    "operationName": "Wall Construction",
    "elementName": "Walls",
    "duration": 8,
    "crew": [{"name": "Mason Crew", "count": 5}],
    "equipment": ["Scaffolding"],
    "dependencies": ["T3"]
  },
  {
    "taskCode": "T5",
    "operationName": "Electrical Work",
    "elementName": "Interior",
    "duration": 6,
    "crew": [{"name": "Electrical Crew", "count": 3}],
    "equipment": [],
    "dependencies": ["T4"]
  },
  {
    "taskCode": "T6",
    "operationName": "Plumbing",
    "elementName": "Interior",
    "duration": 6,
    "crew": [{"name": "Plumbing Crew", "count": 3}],
    "equipment": [],
    "dependencies": ["T4"]
  },
  {
    "taskCode": "T7",
    "operationName": "Roof Installation",
    "elementName": "Roof",
    "duration": 5,
    "crew": [{"name": "Roofing Crew", "count": 4}],
    "equipment": ["Crane"],
    "dependencies": ["T4"]
  },
  {
    "taskCode": "T8",
    "operationName": "Final Inspection",
    "elementName": "Building",
    "duration": 2,
    "crew": [{"name": "Inspector", "count": 1}],
    "equipment": [],
    "dependencies": ["T5", "T6", "T7"]
  }
]

###

### 4. Get All Registered Tasks
GET http://localhost:8080/api/tasks
Accept: application/json

###

### 5. Get Task Count
GET http://localhost:8080/api/tasks/count
Accept: application/json

###

### 6. Clear All Tasks
DELETE http://localhost:8080/api/tasks

###

### Project Planning Endpoints (Using Registered Tasks)

### 7. Get Project Statistics (from registered tasks)
# Uses CPM algorithm to calculate critical path from registered tasks
GET http://localhost:8080/api/project/statistics
Accept: application/json

###

### 8. Get Tasks with Intervals (from registered tasks)
# Returns all registered tasks with calculated start/end intervals and slack values
GET http://localhost:8080/api/project/tasks
Accept: application/json

###

### Error Handling Tests

### 9. Test Error: Invalid Dependency (should return 400 with ErrorRecord)
# First register a task with an invalid dependency
POST http://localhost:8080/api/tasks/register
Content-Type: application/json

[
  {
    "taskCode": "A",
    "operationName": "Task A",
    "elementName": "Element A",
    "duration": 5,
    "crew": [],
    "equipment": [],
    "dependencies": ["NONEXISTENT"]
  }
]

###

### 10. Test Error: Circular Dependency (should return 400 with ErrorRecord)
# Register tasks with circular dependency
POST http://localhost:8080/api/tasks/register
Content-Type: application/json

[
  {
    "taskCode": "A",
    "operationName": "Task A",
    "elementName": "Element A",
    "duration": 5,
    "crew": [],
    "equipment": [],
    "dependencies": ["B"]
  },
  {
    "taskCode": "B",
    "operationName": "Task B",
    "elementName": "Element B",
    "duration": 3,
    "crew": [],
    "equipment": [],
    "dependencies": ["A"]
  }
]

###

### 11. Test Error: Empty Task List (should return 400 with ErrorRecord)
POST http://localhost:8080/api/tasks/register
Content-Type: application/json

[]

###

### 12. Test Error: Get Statistics with No Registered Tasks
# First clear all tasks
DELETE http://localhost:8080/api/tasks

###

# Then try to get statistics (should handle gracefully)
GET http://localhost:8080/api/project/statistics
Accept: application/json

###

### Additional Examples

### 13. Parallel Tasks Example
POST http://localhost:8080/api/tasks/register
Content-Type: application/json

[
  {
    "taskCode": "START",
    "operationName": "Project Start",
    "elementName": "Project",
    "duration": 0,
    "crew": [],
    "equipment": [],
    "dependencies": []
  },
  {
    "taskCode": "PARALLEL_A",
    "operationName": "Parallel Task A",
    "elementName": "Building A",
    "duration": 10,
    "crew": [{"name": "Crew A", "count": 5}],
    "equipment": [],
    "dependencies": ["START"]
  },
  {
    "taskCode": "PARALLEL_B",
    "operationName": "Parallel Task B",
    "elementName": "Building B",
    "duration": 8,
    "crew": [{"name": "Crew B", "count": 5}],
    "equipment": [],
    "dependencies": ["START"]
  },
  {
    "taskCode": "PARALLEL_C",
    "operationName": "Parallel Task C",
    "elementName": "Building C",
    "duration": 12,
    "crew": [{"name": "Crew C", "count": 5}],
    "equipment": [],
    "dependencies": ["START"]
  },
  {
    "taskCode": "END",
    "operationName": "Project Completion",
    "elementName": "Project",
    "duration": 0,
    "crew": [],
    "equipment": [],
    "dependencies": ["PARALLEL_A", "PARALLEL_B", "PARALLEL_C"]
  }
]

###
